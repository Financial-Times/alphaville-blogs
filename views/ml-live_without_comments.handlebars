{{#contentFor "head"}}
	<link rel="stylesheet" href="{{assetsBasePath}}/build/ml-live.css" />

	<script>
		(function () {
			ctmLoadScript({
				src: "//js.pusher.com/2.0.5/pusher.min.js"
			}, function (errPusher) {
				document.addEventListener('o.DOMContentLoaded', function () {
					document.addEventListener('mlLiveBundle.loaded', function () {
						mlLiveBundle.marketsLiveSessionNotification.sessionSeen('{{articleId}}');

						let matchDate = window.location.pathname.match(/[0-9]{4}-[0-9]{2}-[0-9]{2}(-[0-9]+)?/);
						if (matchDate && matchDate.length) {
							matchDate = matchDate[0];
						} else {
							return;
						}
						
						var webChat = new mlLiveBundle.Webchat(document.querySelector('.chat'), {
							articleId: '{{articleId}}',
							apiUrl: '{{mlApiUrl}}/' + matchDate
						});
					});
				});

				ctmLoadScript({
					src: "{{assetsBasePath}}/build/ml-live.js",
					async: true
				}, function () {
					document.dispatchEvent(new CustomEvent('mlLiveBundle.loaded', {
						bubbles: true
					}));
				});
			});
		}());
	</script>
{{/contentFor}}



<div class="session-container" data-trackable="ml-live-without-comments">
	<div class="o-grid-container o-grid-container--bleed">
		<div class="o-grid-row">
			<div data-o-grid-colspan="12">
				<div class="chat-panel">
					<div class="chat" data-trackable="marketslive-chat"></div>
				</div>
			</div>
		</div>
	</div>
</div>
